Just for fun. Code is horrible, was limited on time. "Proof of concept"
http://codexdev.blogspot.com/2011/07/haxe-and-macros.html for a slightly outdated example